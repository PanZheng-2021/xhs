(()=>{"use strict";var t,e,i={},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var o=n[t]={exports:{}};return i[t](o,o.exports,r),o.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(i,n){if(1&n&&(i=this(i)),8&n)return i;if("object"==typeof i&&i){if(4&n&&i.__esModule)return i;if(16&n&&"function"==typeof i.then)return i}var o=Object.create(null);r.r(o);var a={};t=t||[null,e({}),e([]),e(e)];for(var s=2&n&&i;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>i[t]));return a.default=()=>i,r.d(o,a),o},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};class o{constructor(t){this.boundKeyupCallback=this.keyupCallback.bind(this),this.ignoredKeys=new Set(["Alt","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","CapsLock","Control","Escape","Shift","Tab"]),this.onUpdate=t}start(t){this.element=t,this.element.addEventListener("keyup",this.boundKeyupCallback)}stop(){var t;null===(t=this.element)||void 0===t||t.removeEventListener("keyup",this.boundKeyupCallback),this.element=void 0}keyupCallback(t){var e,i;t.altKey||this.ignoredKeys.has(t.key)||this.onUpdate(null!==(i=null===(e=this.element)||void 0===e?void 0:e.innerText)&&void 0!==i?i:"")}}class a{static inputTextExtracted(t,e,i){var n,r;const o=JSON.stringify(i);(null===(n=this.designerNativeHandler)||void 0===n?void 0:n.inputExtracted)?this.designerNativeHandler.inputExtracted(t,e,o):(null===(r=this.designerNativeHandler)||void 0===r?void 0:r.inputTextExtracted)&&this.designerNativeHandler.inputTextExtracted(t,o)}static inputImageExtracted(t){var e,i;null===(i=null===(e=this.designerNativeHandler)||void 0===e?void 0:e.inputImageExtracted)||void 0===i||i.call(e,t)}static composeStarted(t){var e,i;null===(i=null===(e=this.designerNativeHandler)||void 0===e?void 0:e.composeStarted)||void 0===i||i.call(e,t)}static logLocal(t){var e,i;null===(i=null===(e=this.designerNativeHandler)||void 0===e?void 0:e.logLocal)||void 0===i||i.call(e,t)}static onTypingStartedOrResumed(t){var e,i;null===(i=null===(e=this.designerNativeHandler)||void 0===e?void 0:e.onTypingStartedOrResumed)||void 0===i||i.call(e,t)}static onFocusChanged(t){var e,i;null===(i=null===(e=this.designerNativeHandler)||void 0===e?void 0:e.onFocusChanged)||void 0===i||i.call(e,t)}static nativeHandlerSupportShortIdleTime(){var t;return void 0!==(null===(t=this.designerNativeHandler)||void 0===t?void 0:t.onTypingStartedOrResumed)}}a.designerNativeHandler=designerNativeHandler;const s=JSON.parse('{"twitter.com":{"/home":{"contentType":"text","strategy":"paste","dimension":{"width":1600,"height":900},"renderDimension":{"width":1600,"height":900},"runInDark":false,"selectors":"[data-testid=\'tweetTextarea_0\'][role=\'textbox\']:not([data-testid=\'dmComposerTextInput\'])","validateEnablingCriteria":"[data-testid=\'tweetButton\'],[data-testid=\'tweetButtonInline\']","scenario":"Twitter Tweet"},"/compose/tweet":{"contentType":"text","strategy":"paste","dimension":{"width":1600,"height":900},"renderDimension":{"width":1600,"height":900},"runInDark":false,"selectors":"div[role=\'textbox\']:not([data-testid=\'dmComposerTextInput\'])","validateEnablingCriteria":"[data-testid=\'tweetButton\'],[data-testid=\'tweetButtonInline\']","scenario":"Twitter Tweet"}},"facebook.com":{"/":{"contentType":"text","strategy":"paste","dimension":{"width":1200,"height":1200},"renderDimension":{"width":1200,"height":1200},"runInDark":false,"selectors":"div[role=\'dialog\'] div[role=\'textbox\']","validateEnablingCriteria":"[aria-label=\'Feeling/activity\']","scenario":"Facebook Post"}},"linkedin.com":{"/post/new/":{"contentType":"text","strategy":"file","dimension":{"width":800,"height":450},"renderDimension":{"width":800,"height":450},"runInDark":false,"selectors":"textarea","scenario":"LinkedIn Article"},"/feed/":{"contentType":"text","strategy":"paste","dimension":{"width":1080,"height":1080},"renderDimension":{"width":1080,"height":1080},"runInDark":false,"selectors":"div[role=\'dialog\'] div[role=\'textbox\']","scenario":"LinkedIn ShareBox"},"/":{"contentType":"text","strategy":"paste","dimension":{"width":1080,"height":1080},"renderDimension":{"width":1080,"height":1080},"runInDark":false,"selectors":"div[role=\'dialog\'] div[role=\'textbox\']","scenario":"LinkedIn ShareBox"}},"pinterest.com":{"/pin-builder/":{"contentType":"text","strategy":"file","dimension":{"width":1080,"height":1920},"renderDimension":{"width":1080,"height":1920},"runInDark":false,"selectors":"textarea[id^=\'pin-draft-title\']","scenario":"Pinterest Create Pin"}},"business.facebook.com":{"/creatorstudio/home":{"contentType":"text","strategy":"paste","dimension":{"width":1080,"height":1080},"renderDimension":{"width":1080,"height":1080},"runInDark":false,"selectors":"[spellcheck][role=\'textbox\']","scenario":"Meta Business Facebook IG Page"}},"web.whatsapp.com":{"/":{"contentType":"text","strategy":"paste","dimension":{"width":800,"height":800},"renderDimension":{"width":800,"height":800},"runInDark":false,"selectors":"[data-tab=\'10\'][role=\'textbox\']","validateEnablingCriteria":"span[class*=\'selectable-text copyable-text\']:not([dir=\'ltr\']):not([dir=\'auto\'])","scenario":"WhatsApp Group Chat"}}}');var l=r.t(s,2);const d=JSON.parse('{"CaptureTimeBufferMS":1500,"CharacterCountBuffer":100,"GlobalCaptureTimeLimitMS":1450,"GlobalCaptureShortTimeLimitMS":1450,"IdleTimeMS":1500,"ShortIdleTimeMS":1500}');var c,u=r.t(d,2);!function(t){t[t.Unknown=0]="Unknown",t[t["Twitter Tweet"]=1]="Twitter Tweet",t[t["Facebook Post"]=2]="Facebook Post",t[t["LinkedIn Article"]=3]="LinkedIn Article",t[t["Pinterest Create Pin"]=4]="Pinterest Create Pin",t[t["Meta Business Facebook IG Page"]=5]="Meta Business Facebook IG Page",t[t["WhatsApp Group Chat"]=6]="WhatsApp Group Chat"}(c||(c={}));const h=l,p=u,m=new class{constructor(){this.observer=new o(this.onTextChange.bind(this)),this.lastCaptureTime=0,this.lastCapture="",this.boundFocusInEventListener=this.onFocusIn.bind(this),this.scenarioEnum=0,this.composeStarted=!1,this.validateEnablingCriteria="",this.attributeName="data-ms-extractor",this.attributeValue="paste"}start(t){var e,i;a.logLocal(`Extractor: Extractor started for ${t.scenario}...`),this.siteSettings=t,this.scenarioEnum=null!==(e=c[this.siteSettings.scenario])&&void 0!==e?e:c.Unknown,this.validateEnablingCriteria=null!==(i=this.siteSettings.validateEnablingCriteria)&&void 0!==i?i:"",document.body.addEventListener("focusin",this.boundFocusInEventListener,!0)}stop(){this.stopObserver(),this.stopExtractor()}stopExtractor(){document.removeEventListener("focusin",this.boundFocusInEventListener,!0),this.siteSettings=void 0,a.logLocal("Extractor: Extractor stopped")}onFocusIn(){var t;const{activeElement:e}=document;if("password"===(null==e?void 0:e.getAttribute("type"))||"username"===(null==e?void 0:e.getAttribute("type"))||"email"===(null==e?void 0:e.getAttribute("type"))||(null==e?void 0:e.getAttribute("autocomplete")))return void a.logLocal("Extractor: unwanted input type");this.stopObserver();const i=null===(t=this.siteSettings)||void 0===t?void 0:t.selectors;i&&(null==e?void 0:e.matches(i))&&((t,e)=>{if(t){const i=document.querySelector(t);if(c["WhatsApp Group Chat"]===e)return function(t){return null!==t&&""!==t.innerText&&"click here for contact info"!==t.innerText&&"Business Account"!==t.innerText}(i);if(c["Twitter Tweet"]===e)return function(t){return"Post"===(null==t?void 0:t.innerText)}(i);if(c["Facebook Post"]===e)return null!==i}return!0})(this.validateEnablingCriteria,this.scenarioEnum)?(a.logLocal("Extractor: focused on matching element"),this.activeTrackedElement=e,this.startObserver(this.activeTrackedElement),this.composeStarted||(this.composeStarted=!0,a.composeStarted(this.scenarioEnum))):a.logLocal(`Extractor: not a matching element. tag:${null==e?void 0:e.tagName} role:${null==e?void 0:e.getAttribute("role")}`)}startObserver(t){const e=document.querySelector(`[${this.attributeName}="${this.attributeValue}"]`);e&&e.removeAttribute(this.attributeName),this.observer.start(t),t.setAttribute(this.attributeName,this.attributeValue),this.sendFocusChangeEvent(!0),a.logLocal("Extractor: Started observing element")}stopObserver(){var t,e;this.activeTrackedElement&&this.sendFocusChangeEvent(!1),null===(t=this.activeTrackedElement)||void 0===t||t.removeAttribute(this.attributeName),this.observer.stop(),this.clearIdleTimer(),this.lastCaptureTime=0,this.lastCapture="",this.activeTrackedElement=void 0,a.logLocal(`Extractor: Observer stopped for ${null===(e=this.siteSettings)||void 0===e?void 0:e.scenario}`)}onTextChange(t){0===this.lastCaptureTime&&(this.lastCaptureTime=Date.now(),a.logLocal(`Extractor: received first text change: ${t}`)),this.idleTimer?-1===this.idleTimer&&this.lastCapture!==t.trim()&&(a.logLocal(`Extractor: typing resumed for text change: ${t}`),a.onTypingStartedOrResumed(!0)):a.onTypingStartedOrResumed(!1),this.resetIdleTimer(),t.length-this.lastCapture.length>p.CharacterCountBuffer&&Date.now()-this.lastCaptureTime>p.CaptureTimeBufferMS&&this.captureInput()}captureInput(){var t,e,i,n;const r=Date.now();if(!this.siteSettings)return void a.logLocal("Extractor: undefined siteSettings, cannot capture input");const o=a.nativeHandlerSupportShortIdleTime()?p.GlobalCaptureShortTimeLimitMS:p.GlobalCaptureTimeLimitMS;if(Date.now()-this.lastCaptureTime<o)return void a.logLocal(`Extractor: blocked by global time limit of ${o}ms`);const s=(null===(e=null===(t=this.activeTrackedElement)||void 0===t?void 0:t.innerText)||void 0===e?void 0:e.trim())||(null===(n=null===(i=this.activeTrackedElement)||void 0===i?void 0:i.value)||void 0===n?void 0:n.trim())||"";if(!s||s===this.lastCapture)return void a.logLocal(`Extractor: no text or same as last capture, text:${s}`);this.lastCaptureTime=Date.now(),this.lastCapture=s,a.logLocal(`Extractor: input captured: ${s}`);const{dimension:l,renderDimension:d,runInDark:c,scenario:u}=this.siteSettings,h=this.scenarioEnum;a.inputTextExtracted(s,r,{dimension:l,renderDimension:d,runInDark:c,scenario:u,scenarioEnum:h}),"file"===this.siteSettings.strategy&&(a.logLocal("Using input file strategy"),document.onpaste=t=>{if(!t.clipboardData)return void a.logLocal("ev clipboarddata undefined");const e=document.querySelector('input[type="file"]');e.files=t.clipboardData.files;const i=new Event("change",{bubbles:!0});e.dispatchEvent(i)})}resetIdleTimer(){this.clearIdleTimer(),this.idleTimer=window.setTimeout((()=>{this.captureInput(),this.idleTimer=-1}),a.nativeHandlerSupportShortIdleTime()?p.ShortIdleTimeMS:p.IdleTimeMS)}clearIdleTimer(){this.idleTimer&&-1!==this.idleTimer&&(window.clearTimeout(this.idleTimer),this.idleTimer=-1)}sendFocusChangeEvent(t){this.focusChangeTimer&&clearTimeout(this.focusChangeTimer),this.focusChangeTimer=setTimeout((()=>{a.onFocusChanged(t),a.logLocal(`Extractor: onFocusChanged: ${t}`)}),100)}};function v(){const{location:t}=window,e=(i=t.hostname).startsWith("www.")?i.replace("www.",""):i;var i;const n=h[e];if(!n)return void a.logLocal("Extractor: not a supported hostname");const r=n[t.pathname];r?m.start(r):a.logLocal("Extractor: not a supported page")}"loading"===document.readyState?(a.logLocal("Extractor: waiting for DOMContentLoaded"),document.addEventListener("DOMContentLoaded",(()=>{v()}))):v()})();